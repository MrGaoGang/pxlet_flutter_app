import 'dart:convert';

import 'package:dio/dio.dart';
import 'package:pxlet_flutter_app/model/news.dart';


/**
 * get recent news
 */
Future<List<NewsItem>>  getNews(String platform, [int num = 20]) async {
  print('request ${platform}');
  final dio = Dio();
  dio.options.baseUrl = 'https://www.pxlet.com/lib/api';
  dio.options.connectTimeout = 20000; //5s
  var formData = FormData.fromMap({'cmd': 'get', 'type': platform, 'num': num});

  var response = await dio.post('/techtrend.php', data: formData);

  print('Response status: ${response.statusCode}');

  var list =  newsItemFromJson(response.data) ;
  return list;
  // return newsItemFromJson('[{"title":"\u602a\u5f02\u76d2\u6a21\u578bborder-box\u771f\u7684\u4e00\u65e0\u662f\u5904\u5417\uff1f","url":"https:\/\/juejin.cn\/post\/7132826677469511716","link":"https:\/\/juejin.cn\/post\/7132826677469511716","_id":"7132826677469511716"},{"title":"\u538b\u529b\u6d4b\u8bd5-JMeter\u5b89\u88c5\u3001\u5165\u95e8\u3001\u7ed3\u679c\u5206\u6790","url":"https:\/\/juejin.cn\/post\/7132829647674277919","link":"https:\/\/juejin.cn\/post\/7132829647674277919","_id":"7132829647674277919"},{"title":"\u3010Linux\u5fc5\u77e5\u5fc5\u4f1a\u3011\u5982\u4f55\u67e5\u770b\u8fdb\u7a0b&\u6570\u5b57\u6cd5\u548c\u6587\u672c\u6cd5\u4fee\u6539\u6743\u9650","url":"https:\/\/juejin.cn\/post\/7132827022585233445","link":"https:\/\/juejin.cn\/post\/7132827022585233445","_id":"7132827022585233445"},{"title":"Android 13 \u6b63\u5f0f\u7248\u53d1\u5e03","url":"https:\/\/juejin.cn\/post\/7132720318736515085","link":"https:\/\/juejin.cn\/post\/7132720318736515085","_id":"7132720318736515085"},{"title":"\u5c0f\u518c\u4e0a\u65b0\uff5cSkyWalking\uff1a\u5e94\u7528\u76d1\u63a7\u548c\u94fe\u8def\u8ddf\u8e2a","url":"https:\/\/juejin.cn\/book\/7126538479051210766?utm_source=web_feed&utm_medium=banner&utm_campaign=Book_SK_0817","link":"https:\/\/juejin.cn\/book\/7126538479051210766?utm_source=web_feed&utm_medium=banner&utm_campaign=Book_SK_0817","_id":2585},{"title":"\u6df1\u5165\u5256\u6790Spring Boot \u7684SPI\u673a\u5236","url":"https:\/\/juejin.cn\/post\/7132742686099898398","link":"https:\/\/juejin.cn\/post\/7132742686099898398","_id":"7132742686099898398"},{"title":"\u3010Go-Ginrest\u3011\u4e00\u884c\u4ee3\u7801\u5b9e\u73b0\u4e00\u4e2aRESTful\u63a5\u53e3","url":"https:\/\/juejin.cn\/post\/7132790934353215502","link":"https:\/\/juejin.cn\/post\/7132790934353215502","_id":"7132790934353215502"},{"title":"\u4e91\u97f3\u4e50\u64ad\u653e\u9875\u76f4\u64ad\u63a8\u8350\u5b9e\u6218","url":"https:\/\/juejin.cn\/post\/7132802106611744804","link":"https:\/\/juejin.cn\/post\/7132802106611744804","_id":"7132802106611744804"},{"title":"\u5982\u4f55\u505a\u597d\u5206\u5e03\u5f0f\u4efb\u52a1\u8c03\u5ea6\u2014\u2014Scheduler \u7684\u4e00\u4e9b\u63a2\u7d22","url":"https:\/\/juejin.cn\/post\/7132753859134357534","link":"https:\/\/juejin.cn\/post\/7132753859134357534","_id":"7132753859134357534"},{"title":"8\u6708\u66f4\u6587\u6d3b\u52a8\u6765\u5566\uff01\u643a\u624b\u521b\u4f5c\uff0c\u5171\u540c\u6210\u957f\uff01","url":"https:\/\/juejin.cn\/post\/7123120819437322247?utm_source=web10&utm_medium=feed&utm_campaign=gengwen202208","link":"https:\/\/juejin.cn\/post\/7123120819437322247?utm_source=web10&utm_medium=feed&utm_campaign=gengwen202208","_id":2503},{"title":"\u4ece\u51fd\u6570\u67ef\u91cc\u5316\u804a\u5230add(1)(2)(3) add(1, 2)(3)\uff0c\u4ee5\u53ca\u67ef\u91cc\u5316\u65e0\u9650\u8c03\u7528","url":"https:\/\/juejin.cn\/post\/7132751786451927047","link":"https:\/\/juejin.cn\/post\/7132751786451927047","_id":"7132751786451927047"},{"title":" C# Chart\u63a7\u4ef6\u6807\u8bb0\u95ee\u9898","url":"https:\/\/juejin.cn\/post\/7132818750155259912","link":"https:\/\/juejin.cn\/post\/7132818750155259912","_id":"7132818750155259912"},{"title":"\u5341\u5206\u949f\uff0c\u5e26\u4f60\u5feb\u901f\u638c\u63e1 Dubbo \u7684\u67b6\u6784\u8bbe\u8ba1","url":"https:\/\/juejin.cn\/post\/7132680001245151269","link":"https:\/\/juejin.cn\/post\/7132680001245151269","_id":"7132680001245151269"},{"title":"Spring | \u4e8b\u52a1\u6ca1\u6709\u751f\u6548\u5bfc\u81f4\u6570\u636e\u6ca1\u6709\u6301\u4e45\u5316\u7684\u63a2\u7a76","url":"https:\/\/juejin.cn\/post\/7132713117263331365","link":"https:\/\/juejin.cn\/post\/7132713117263331365","_id":"7132713117263331365"},{"title":"\u57fa\u4e8e\u6587\u672c\u6316\u6398\u7684\u4f01\u4e1a\u9690\u60a3\u6392\u67e5\u8d28\u91cf\u5206\u6790\u6a21\u578b ","url":"https:\/\/juejin.cn\/post\/7132516661847916581","link":"https:\/\/juejin.cn\/post\/7132516661847916581","_id":"7132516661847916581"},{"title":"MVCC\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236","url":"https:\/\/juejin.cn\/post\/7132693076396474405","link":"https:\/\/juejin.cn\/post\/7132693076396474405","_id":"7132693076396474405"},{"title":"CI\/CD\u7cfb\u5217 | \u5982\u4f55\u628a\u6301\u7eed\u96c6\u6210\u653e\u5728\u672c\u5730\uff1f","url":"https:\/\/juejin.cn\/post\/7132743208726953998","link":"https:\/\/juejin.cn\/post\/7132743208726953998","_id":"7132743208726953998"},{"title":"\u4ece\u5783\u573e\u56de\u6536\uff08GC\uff09\u5230\u5185\u5b58\u6cc4\u6f0f\uff0c\u4e00\u6587\u901a\u900f","url":"https:\/\/juejin.cn\/post\/7132762592329596965","link":"https:\/\/juejin.cn\/post\/7132762592329596965","_id":"7132762592329596965"},{"title":"Java\u5b9e\u6218\uff1a\u6307\u5b9a\u5927\u5c0f\u5206\u7ec4\u538b\u7f29\u6587\u4ef6\u5939\u91cc\u9762\u7684\u6587\u4ef6\u6848\u4f8b","url":"https:\/\/juejin.cn\/post\/7132638265491849230","link":"https:\/\/juejin.cn\/post\/7132638265491849230","_id":"7132638265491849230"},{"title":"\u4e00\u6587\u641e\u5b9a\u524d\u540e\u7aef\u6240\u6709\u9274\u6743\u65b9\u6848\u3001Android \u89e3\u51b3\u201c\u7ade\u6001\u95ee\u9898\u201d\uff5c\u6398\u91d1\u4e00\u5468 08.17","url":"https:\/\/juejin.cn\/post\/7132742700779978783?utm_source=web20&utm_medium=feed&utm_campaign=juejin1week_0817","link":"https:\/\/juejin.cn\/post\/7132742700779978783?utm_source=web20&utm_medium=feed&utm_campaign=juejin1week_0817","_id":2592}]');
}
